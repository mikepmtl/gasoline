<?php \Theme::instance()->set_partial('page-header', \Theme::instance()->view('admin/_partials/page-header')); ?>

<div class="row">
  <div class="col-md-10">
    <div class="row">
      <div class="col-md-7">
        <section class="panel">
          <header class="panel-heading bg-light lter"><?php echo html_tag('h4', array('class' => 'panel-title'), __('modules.navigation.admin.page-title.details', array('name' => html_tag('small', array(), e($module->name))))); ?></header>
          <?php
          
          \Package::load('table');
          
          $table = \Table\Table::forge(array('class' => 'table table-striped table-responsive table-hover'));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.name'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(e($module->name))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.slug'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(e($module->slug))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.author'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(e($module->author))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.version'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(e($module->version))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.status'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(__('modules.model.module.options.status.' . $module->status))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.scope'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(__('modules.model.module.options.scope.' . $module->scope))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.protected'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(__('modules.model.module.options.protected.' . $module->protected))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.created_at'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(\Date::time_ago($module->created_at))
          ));
          
          $table[] = \Table\Row::forge(array(
            \Table\Cell::forge(__('modules.model.module.updated_at'))->set_type(\Table\Cell::HEADER),
            \Table\Cell::forge(
              $module->updated_at
              ? \Date::time_ago($module->updated_at)
                . ' '
                . __('global.by')
                . ' '
                . (
                  \Auth::has_access('users.admin[read]')
                  ? ( $module->auditor
                    ? \Html::anchor(
                      'admin/auth/users/details/'
                      . $module->auditor->id,
                      e($module->auditor->username)
                      . '&nbsp;<i class="fa fa-share-alt"></i>',
                      array(
                        'class' => 'text-primary'
                      )
                    )
                    : __('global.n/a')
                  )
                  : ( $module->auditor
                    ? e($module->auditor->username)
                    : __('global.n/a')
                  )
                )
              : __('global.never')
            )
          ));
          
          echo $table->render();
          
          ?>
        </section>
      </div>
      
      <div class="col-md-5">
        <section class="panel">
          <header class="panel-heading bg-light dk"><?php echo html_tag('h4', array('class' => 'panel-title'), __('modules.model.module.description.short')); ?></header>
          <div class="panel-body">
            <?php echo e($module->description['short']); ?>
          </div>
        </section>
        <section class="panel">
          <header class="panel-heading bg-light dk"><?php echo html_tag('h4', array('class' => 'panel-title'), __('modules.model.module.description.long')); ?></header>
          <div class="panel-body">
            <?php echo e($module->description['long']); ?>
          </div>
        </section>
      </div>
      
    </div>
    
    <section class="panel">
      <header class="panel-heading bg-light lter"><?php echo html_tag('h4', array('class' => 'panel-title'), __('global.widget') . '&nbsp;' . html_tag('small', array(), e($module->name))); ?></header>
      <div class="panel-body">
        <?php if ( isset($widget) && $widget ) : ?>
          <?php echo $widget['body']; ?>
        <?php else : ?>
          <div class="row">
            <div class="col-md-6 col-md-offset-3">
              <section class="panel text-center no-border bg-warning dker">
                <div class="panel-body">
                  <p><i class="fa fa-exclamation-triangle fa-4x"></i></p>
                  <p class="h5"><?php echo __('global.no_data_found'); ?></p>
                </div>
              </section>
            </div>
          </div>
        <?php endif; ?>
      </div>
    </section>
    
  </div>
  <div class="col-md-2">
    <section class="panel">
      <header class="panel-heading bg-primary lter"><?php echo html_tag('h4', array('class' => 'panel-title'), __('global.navigation')); ?></header>
      <div class="list-group">
        <?php if ( \Auth::has_access('modules.admin[list]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules',
            '<i class="fa fa-angle-double-left fa-fw"></i>&nbsp;&nbsp;' . __('button.list'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php endif; ?>
        <?php if ( \Auth::has_access('modules.admin[upload]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules/upload',
            '<i class="fa fa-plus fa-fw"></i>&nbsp;&nbsp;' . __('button.new'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php endif ;?>
        <?php if ( $module->is_enabled() && \Auth::has_access('modules.admin[disable]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules/disable/' . $module->slug,
            '<i class="fa fa-minus fa-fw"></i>&nbsp;&nbsp;' . __('button.disable'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php elseif ( $module->is_disabled() && \Auth::has_access('modules.admin[enable]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules/enable/' . $module->slug,
            '<i class="fa fa-plus fa-fw"></i>&nbsp;&nbsp;' . __('button.enable'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php endif; ?>
        <?php if ( $module->is_deletable() && \Auth::has_access('modules.admin[delete]') ) : 
          echo \Html::anchor(
            'admin/modules/delete/' . $module->slug,
            '<i class="fa fa-trash-o fa-fw"></i>&nbsp;&nbsp;' . __('button.delete'),
            array(
              'class'   => 'list-group-item',
            )
          );
          endif ;
        ?>
      </div>
    </section>
  </div>
</div>

