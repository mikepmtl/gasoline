<?php \Theme::instance()->set_partial('page-header', \Theme::instance()->view('admin/page-headers/details')); ?>

<div class="row">
  <div class="col-md-10">
    <section class="panel">
      <header class="panel-heading"><?php echo html_tag('span', array('class' => 'h4'), __('module.page-title.details', array('name' => e($module->name)))); ?></header>
      <?php
      
      \Package::load('table');
      
      $table = \Table\Table::forge()->set_attribute('class', 'table table-striped table-hover');
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.name'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(e($module->name), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.slug'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(e($module->slug), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.author'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(e($module->author), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.version'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(e($module->version), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.status'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(__('module.model.module.options.status.' . $module->status), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.scope'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(__('module.model.module.options.scope.' . $module->scope), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.protected'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(__('module.model.module.options.protected.' . $module->protected), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.created_at'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(\Date::time_ago($module->created_at), array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.updated_at'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge(
          $module->updated_at
          ? \Date::time_ago($module->updated_at)
            . ' '
            . __('global.by')
            . ' '
            . (
              \Auth::has_access('users.admin[read]')
              ? ( $module->auditor
                ? \Html::anchor(
                  'admin/auth/users/details/'
                  . $module->auditor->id,
                  e($module->auditor->username)
                  . '&nbsp;<i class="icon-share-alt"></i>',
                  array(
                    'class' => 'text-primary'
                  )
                )
                : __('global.n/a')
              )
              : ( $module->auditor
                ? e($module->auditor->username)
                : __('global.n/a')
              )
            )
          : __('global.never'),
          array(),
          \Table\Cell::BODY
        )
      ));
    
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.description.short'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge($module->description['short'], array(), \Table\Cell::BODY)
      ));
      
      $table->get_body()->add_row(array(
        \Table\Cell::forge(__('module.model.module.description.long'), array(), \Table\Cell::HEADER),
        \Table\Cell::forge($module->description['long'], array(), \Table\Cell::BODY)
      ));
      
      echo $table->render();
      
      ?>
    </section>
    
    <section class="panel">
      <header class="panel-heading"><?php echo html_tag('span', array('class' => 'h4'), __('module.widget', array('name' => e($module->name)))); ?></header>
      <div class="panel-body">
        <?php if ( isset($widget) && $widget ) : ?>
          <?php echo $widget['body']; ?>
        <?php else : ?>
          <div class="row">
            <div class="col-md-6 col-md-offset-3">
              <section class="panel text-center no-border bg-warning dker">
                <div class="panel-body">
                  <p><i class="icon-exclamation-sign icon-4x"></i></p>
                  <p class="h5"><?php echo __('global.no_data'); ?></p>
                </div>
              </section>
            </div>
          </div>
        <?php endif; ?>
      </div>
    </section>
    
  </div>
  <div class="col-md-2">
    <section class="panel">
      <header class="panel-heading bg-primary lter"><?php echo html_tag('span', array('class' => 'h5'), __('global.navigation')); ?></header>
      <div class="list-group">
        <?php if ( \Auth::has_access('modules.admin[list]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules',
            '<i class="icon-double-angle-left icon-fixed-width"></i>&nbsp;&nbsp;' . __('button.list'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php endif; ?>
        <?php if ( \Auth::has_access('modules.admin[upload]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules/upload',
            '<i class="icon-plus icon-fixed-width"></i>&nbsp;&nbsp;' . __('button.new'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php endif ;?>
        <?php if ( $module->is_enabled() && \Auth::has_access('modules.admin[disabled]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules/disable/' . $module->slug,
            '<i class="icon-minus-sign icon-fixed-width"></i>&nbsp;&nbsp;' . __('button.disable'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php elseif ( $module->is_disabled() && \Auth::has_access('modules.admin[enable]') ) : ?>
        <?php
          echo \Html::anchor(
            'admin/modules/enable/' . $module->slug,
            '<i class="icon-plus-sign icon-fixed-width"></i>&nbsp;&nbsp;' . __('button.enable'),
            array(
              'class'   => 'list-group-item',
            )
          );
        ?>
        <?php endif; ?>
        <?php if ( $module->is_deletable() && \Auth::has_access('modules.admin[delete]') ) : 
          echo \Html::anchor(
            'admin/modules/delete/' . $module->slug,
            '<i class="icon-trash icon-fixed-width"></i>&nbsp;&nbsp;' . __('button.delete'),
            array(
              'class'   => 'list-group-item',
            )
          );
          endif ;
        ?>
      </div>
    </section>
  </div>
</div>

